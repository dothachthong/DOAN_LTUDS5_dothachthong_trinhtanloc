CREATE DATABASE QUANLYNHASACH

CREATE TABLE admin
(
	username nchar(10) not null , primary key(username),
	password nchar(10) not null ,
	quyen nvarchar(20) not null 
)

CREATE TABLE THELOAI
(
	MaTL nchar(10) not null, primary key(MaTL),
	TenTL nvarchar(50) not null,
	DienGia nvarchar(50) 
)

CREATE TABLE NHOMLOAI
(
	MaNL nchar(10) not null, primary key(MaNL),
	TenNL nvarchar(100) not null,
	MaCL nchar(10) not null foreign key(MaCL) references CHUNGLOAI(MACL)
)

CREATE TABLE CHUNGLOAI
(
	MaCL nchar(10) not null, primary key(MaCL),
	TenCL nvarchar(100) not null,
	MaTL nchar(10) not null foreign key(MaTL) references THELOAI(MaTL),
	DienGiai nvarchar(50) 
)
GO
CREATE TABLE NSX
(
	MaNSX nchar(10)  not null, primary key(MaNSX),
	TenNSX nvarchar(100) not null,
	DiaChi nvarchar(50) not null,
	SDT int 
)

CREATE TABLE SACH
(
	MaSach nchar(10) not null, primary key(MaSach),
	TenSach nvarchar(100) not null,
	Gia float ,
	NamSX int ,
	MaTL NCHAR(10) NOT NULL FOREIGN KEY(MaTL) REFERENCES THELOAI(MaTL),
	MaNL NCHAR(10) NOT NULL FOREIGN KEY(MaNL) REFERENCES NHOMLOAI(MaNL)
)
--THAM SACH
CREATE PROC SP_THEMSACH(@MaSach nchar(10),@TenSach nvarchar(100),@Gia float,@NamSX int,
@MaTL nchar(10),@MaNL nchar(10))
AS
INSERT INTO SACH(MaSach,TenSach,Gia,NamSX,MaTL,MaNL)
VALUES (@MaSach,@TenSach,@Gia,@NamSX,@MaTL,@MaNL)

EXEC SP_THEMSACH '1','ok men','6969','2111','1','1' 

--LAY DS SACH
CREATE PROC SP_LAYDSSACH
AS
SELECT *
FROM SACH


--XOA SACH

CREATE PROC SP_XOASACH(@MaSach nchar(10))
AS
DELETE FROM SACH WHERE MaSach = @MaSach
--CAP NHAP SACH
CREATE PROC SP_CAPNHAPSACH(@MaSach nchar(10),@TenSach nvarchar(100),@Gia float,@NamSX int,
@MaTL nchar(10),@MaNL nchar(10))
AS
UPDATE SACH
SET TenSach = @TenSach, Gia = @Gia, NamSX=@NamSX
WHERE MaSach = @MaSach



GO
CREATE TABLE NHACUNGCAP
(
	MaNCC nchar(10)not null , primary key(MaNCC),
	TenNCC nvarchar(100) not null,
	DiaChi nvarchar(50) not null,
	SDT int
)
GO
CREATE TABLE NHANVIENN
(
	MaNV nchar(10) not null, primary key(MaNV),
	TenNV nvarchar(80) not null,
	ChucVu nvarchar(50)not null,
	DiaChi nvarchar(50) not null,
	GioiTinh nchar(5), 
	SDT int 
)
GO
CREATE TABLE THIETBI 
(
	MaTB nchar(10) not null, primary key(MaTB),
	TenTB nvarchar(100) not null,
	DVT nchar(50) not null,
	DVT_Max nchar(10) ,
	DonGia int not null,
	GiaNhap int not null,
	SoLuongTon int not null,
	NgayCapNhap date ,
	MaNL nchar(10) not null foreign key (MaNL) references NHOMLOAI(MaNL),
	MaNSX nchar(10) not null foreign key (MaNSX) references NSX(MaNSX),
	MaKho nchar(10) not null foreign key (MaKho) references KHO(MaKho)
)
GO
CREATE TABLE KHO
(
	MaKho nchar(10) not null, primary key(MaKho),
	TenKho nvarchar(50) not null
)
GO
CREATE TABLE KHACHHANG
(
	MaKH nchar(10) not null, primary key(MaKH),
	TenKH nvarchar(80) not null ,
	MST Nvarchar(20) not null,
	DiaChi nvarchar(50) not null,
	GioiTinh nchar(5) ,
	SDT int
)
GO
CREATE TABLE HOADON
(
	SoHD nchar(10) not null, primary key(SoHD),
	NgayLap_HD date not null,
	ThueXuat nchar(20) ,
	TongGiaTri int not null,
	MaNV nchar(10) not null foreign key(MaNV) references NHANVIENN(MaNV),
	MaKH nchar(10) not null foreign key(MaKH) references KHACHHANG(MaKH)
)
GO
CREATE TABLE CT_HOADON
(
	SoHD nchar(10) not null , primary key(SoHD),
	MaTB nchar(10) not null ,
	SoLuong int not null,
	DonGia int not null,
	ThanhTien int not null
)
GO
CREATE TABLE PHIEUNHAP
(
	SoPN nchar(10) not null, primary key(SoPN),
	NgayNhap_PN date not null,
	ThueXuat nchar(20) ,
	TongGiaTri int not null,
	MaNV nchar(10) not null foreign key(MaNV) references NHANVIENN(MaNV),
	MaNCC nchar(10) not null  foreign key(MaNCC) references NHACUNGCAP(MaNCC)
)
GO
CREATE TABLE CT_PHIEUNHAP
(
	SoPN nchar(10)not null, primary key(SoPN),
	MaTB nchar(10) not null,
	SoLuong int not null,
	GiaNhap int not null,
	ThanhTien int not null
)
GO
CREATE TABLE PHIEUCHI
(
	SoPC nchar(10) not null, primary key(SoPC),
	NgayLap_PC date not null,
	LyDoChi nvarchar(50) not null,
	SoTienChi int not null,
	SoPN nchar(10) not null foreign key(SoPN) references PHIEUNHAP(SoPN)
)
GO
CREATE TABLE TB_THANHLY
(
	MaThanhLy nchar(10) not null, primary key(MaThanhLy),
	NgayThanhLy date not null,
	LyDoChiThanhLy nvarchar(50) ,
	HinhThucThanhLy nvarchar(50)not null,
	GhiChu nvarchar(50) 
)
GO
CREATE TABLE CT_THANHLY
(
	MaThanhLy nchar(10)  not null, primary key(MaThanhLy),
	MaTB nchar(10) not null,
	SoLuong int not null,
	DonGia int not null,
	ThanhTien int not null
)
GO


SET DATEFORMAT DMY
INSERT INTO admin(username,password,quyen)
VALUES ('tanloc','123456',N'Sách Hari Bóc Tõ')
INSERT INTO admin(username,password,quyen)
VALUES ('thachthong','123456',N'Sách SMLDA')
--THEM ADMIN
CREATE PROC SP_THEMADMIN(@username nchar(10), @password nchar(10),@quyen nvarchar(20))
AS INSERT INTO admin(username,password,quyen)
VALUES (@username,@password,@quyen)

--XOA ADMIN
CREATE PROC SP_XOAADMIN(@usename nchar(10))
AS DELETE FROM admin WHERE username = @usename

--lay thong tin ADMIN
CREATE PROC LAYDSADMIN
AS
SELECT * FROM admin
EXEC LAYDSADMIN

EXEC SP_THEMADMIN 'loc','123456',N'SACH C#'
EXEC SP_THEMADMIN 'THONG','123456',N'SACH C++'
EXEC SP_THEMADMIN 'LAN','123456',N'SACH C'
EXEC SP_THEMADMIN 'LINH','123456',N'SACH SQL'


INSERT INTO THELOAI(MaTL,TenTL,DienGia)
VALUES ('1',N'MANGA',N'baka desu')
INSERT INTO THELOAI(MaTL,TenTL,DienGia)
VALUES ('2',N'L?p Tr?nh',N'H?c Khó L?m À Nghen')
INSERT INTO THELOAI(MaTL,TenTL,DienGia)
VALUES ('2',N'Ngo?i Ng?',N'YEAH! WTF BABY')
INSERT INTO THELOAI(MaTL,TenTL,DienGia)
VALUES ('3',N'Ð?i S?ng',N'X? H?i Th?t Chán')

--THEM THE LOAI
CREATE PROC SP_THEMTHELOAI(@MaTL nchar(10),@TenTL nvarchar(50),@DienGia nvarchar(50))
AS INSERT INTO THELOAI(MaTL,TenTL,DienGia)
VALUES (@MaTL,@TenTL,@DienGia)

EXEC SP_THEMTHELOAI '4','HÀNH Ð?NG','Ð?NK KOUT'

--XOA THE LOAI
CREATE PROC SP_XOATHELOAI(@MaTL nchar(10))
AS DELETE FROM THELOAI WHERE  MaTL= @MaTL

--lay thong tin THE LOAI
CREATE PROC LAYDSTHELOAI
AS
SELECT * FROM THELOAI
EXEC LAYDSTHELOAI

-- THEM NHOM LOAI
CREATE PROC SP_THEMNHOMLOAI(@MaNL nchar(10), @TenNL nvarchar(100),@MaCL nchar(10))
AS INSERT INTO NHOMLOAI(MaNL,TenNL,MaCL)
VALUES (@MaNL,@TenNL,@MaCL)

EXEC SP_THEMNHOMLOAI '4','SÁCH TI?N ÍCH','3'


--XOA NHOM LOAI
CREATE PROC SP_XOANHOMLOAI(@MaNL nchar(10))
AS DELETE FROM NHOMLOAI WHERE MaNL = @MaNL

--lay thong tin NHOM LOAI
CREATE PROC LAYDSNHOMLOAI
AS
SELECT * FROM NHOMLOAI
EXEC LAYDSNHOMLOAI

INSERT INTO NHOMLOAI(MaNL,TenNL,MaCL)
VALUES ('1',N'SÁCH GI?I TRÍ','1')
INSERT INTO NHOMLOAI(MaNL,TenNL,MaCL)
VALUES ('2',N'SÁCH H?C T?P','2')
INSERT INTO NHOMLOAI(MaNL,TenNL,MaCL)
VALUES ('3',N'SÁCH Ð?I S?NG X? H?I','3')


INSERT INTO CHUNGLOAI(MaCL,TenCL,MaTL,DienGiai)
VALUES ('1',N'SÁCH GI?I TRÍ','1',N'VUI THÔI')
INSERT INTO CHUNGLOAI(MaCL,TenCL,MaTL,DienGiai)
VALUES ('2',N'SÁCH H?C T?P','2',N'H?C RI?T H?C M?I')
INSERT INTO CHUNGLOAI(MaCL,TenCL,MaTL,DienGiai)
VALUES ('3',N'SÁCH Ð?I S?NG X? H?I','3',N'CU?C Ð?I V?N Ð?P SAO')

-- THEM CHUNGLOAI
CREATE PROC SP_CHUNGLOAI(@MaCL nchar(10),@TenCL nvarchar(100),@MaTL nchar(10),@DienGiai nvarchar(50))
AS INSERT INTO CHUNGLOAI(MaCL,TenCL,MaTL,DienGiai)
VALUES (@MaCL,@TenCL,@MaTL,@DienGiai)

EXEC SP_CHUNGLOAI '4',N'SÁCH X?N','2',N'OK MEN'

--XOA CHUNGLOAI
CREATE PROC SP_XOACHUNGLOAI(@MaCL nchar(10))
AS DELETE FROM CHUNGLOAI WHERE MaCL = @MaCL

--lay thong tin CHUNGLOAI
CREATE PROC LAYDSCHUNGLOAI
AS
SELECT * FROM CHUNGLOAI
EXEC LAYDSCHUNGLOAI


INSERT INTO NSX(MaNSX,TenNSX,DiaChi,SDT)
VALUES ('1',N'NXB TP.HCM',N'QU?N 1 , TP.HCM',092534553)
INSERT INTO NSX(MaNSX,TenNSX,DiaChi,SDT)
VALUES ('2',N'NXB HÀ N?I',N'QU?N BA Ð?NH , HÀ N?I',053434553)
INSERT INTO NSX(MaNSX,TenNSX,DiaChi,SDT)
VALUES ('3',N'NXB V?NG TÀU',N'V? TH? SÁU , TP.V?NG TÀU',0422534553)

--THEM NSX
CREATE PROC SP_NSX (@MaNSX nchar(10),@TenNSX nvarchar(100),@DiaChi nvarchar(50),@SDT int)
AS INSERT INTO NSX(MaNSX,TenNSX,DiaChi,SDT)
values (@MaNSX,@TenNSX,@DiaChi,@SDT)

EXEC SP_NSX '4','NXB DB',N'TP.HCM',363564576 

--XOA NSX
CREATE PROC SP_XOANSX(@MaNSX nchar(10))
AS DELETE FROM NSX WHERE MaNSX = @MaNSX

--lay thong tin NSX
CREATE PROC LAYDSNSX
AS
SELECT * FROM NSX
EXEC LAYDSNSX

INSERT INTO NHACUNGCAP(MaNCC,TenNCC,DiaChi,SDT)
VALUES ('1',N'CÔNG TY SÁCH HÝNG TH?NH',N'S? 23 , TÂN PHÚ, TP.HCM',09434543)
INSERT INTO NHACUNGCAP(MaNCC,TenNCC,DiaChi,SDT)
VALUES ('2',N'CÔNG TY SÁCH THÀNH Ð?T',N'S? 99 , G? V?P, TP.HCM',094454543)
INSERT INTO NHACUNGCAP(MaNCC,TenNCC,DiaChi,SDT)
VALUES ('3',N'CÔNG TY SÁCH TOÀN PHÁT',N'109 , QU?N TÂY H?, HÀ N?I',094455643)
--THEM NHA CUNG CAP
CREATE PROC SP_NHACUNGCAP(@MaNCC NCHAR(10), @TenNCC nvarchar(100), @DiaChi nvarchar(50), @SDT INT)
AS INSERT INTO NHACUNGCAP(MaNCC,TenNCC,DiaChi,SDT)
VALUES (@MaNCC,@TenNCC,@DiaChi,@SDT)

EXEC SP_NHACUNGCAP '4',N'CTY TH?NG L?I',N'69 TR?N DUY HÝNG',567586

--XOA NHA CUNG CAP
CREATE PROC SP_XOANHACUNGCAP(@MaNCC nchar(10))
AS DELETE FROM NHACUNGCAP WHERE MaNCC = @MaNCC

--lay thong tin NHA CUNG CAP
CREATE PROC LAYDSNHACUNGXAP
AS
SELECT * FROM NHACUNGCAP
EXEC LAYDSNHACUNGXAP


INSERT INTO NHANVIENN(MaNV,TenNV,ChucVu,DiaChi,GioiTinh,SDT)
VALUES ('QL1',N'TR?NH T?N L?C',N'T?NG GIÁM Ð?C','ÐÔNG TH?NH , HÓC MÔN','NAM',059879724)
INSERT INTO NHANVIENN(MaNV,TenNV,ChucVu,DiaChi,GioiTinh,SDT)
VALUES ('NV1',N'D? TH?CH THÔNG',N'B?O V?','Ð?O C?A QU?','3D',035663524)
INSERT INTO NHANVIENN(MaNV,TenNV,ChucVu,DiaChi,GioiTinh,SDT)
VALUES ('QL2',N'CHÂU TINH TR?',N'GIÁM Ð?C','TÂY T?NG','NAM',043423524)
INSERT INTO NHANVIENN(MaNV,TenNV,ChucVu,DiaChi,GioiTinh,SDT)
VALUES ('NV2',N'LÊ THÀNH VI?T',N'NHÂN VIÊN MAKETING','LONG AN','NAM',023423524)
INSERT INTO NHANVIENN(MaNV,TenNV,ChucVu,DiaChi,GioiTinh,SDT)
VALUES ('NV3',N'NGUY?N VÂN NGA',N'THÝ KÍ ','TP.HCM','NU',093423524)

--THEM NHANVIEN
CREATE PROC SP_NHANVIENN(@MaNV NCHAR(10),@TenNV NVARCHAR(80),@ChucVu NVARCHAR(50),@DiaChi NVARCHAR(50),@GioiTinh NCHAR(5),@SDT INT)
AS INSERT INTO NHANVIENN(MaNV,TenNV,ChucVu,DiaChi,GioiTinh,SDT)
VALUES (@MaNV,@TenNV,@ChucVu,@DiaChi,@GioiTinh,@SDT)

EXEC SP_NHANVIENN 'NV4','TOKUDA',N'DI?N VIÊN',N'NH?T B?N','NAM',535636

--XOA NHANVIENN
CREATE PROC SP_XOANHANVIENN(@MaNV nchar(10))
AS DELETE FROM NHANVIENN WHERE MaNV = @MaNV

--lay thong tin NHANVIENN
CREATE PROC LAYDSNHANVIEN
AS
SELECT * FROM NHANVIENN
EXEC LAYDSNHANVIEN

INSERT INTO KHO(MaKho,TenKho)
VALUES ('1',N'KHO V?NH AN')
INSERT INTO KHO(MaKho,TenKho)
VALUES ('2',N'KHO THIÊN L?I')
INSERT INTO KHO(MaKho,TenKho)
VALUES ('3',N'KHO Ð?NG QUÂN')

--THEM KHO
CREATE PROC SP_KHO(@MaKho nchar(10),@TenKho nvarchar(50))
AS INSERT INTO KHO(MaKho,TenKho)
VALUES (@MaKho,@TenKho)

EXEC SP_KHO '4',N'KHO BIÊN H?A'

--XOA KHO
CREATE PROC SP_XOAKHO(@MaKho nchar(10))
AS DELETE FROM KHO WHERE MaKho = @MaKho

--lay thong tin KHO 
CREATE PROC LAYDSKHO
AS
SELECT * FROM KHO
EXEC LAYDSKHO

INSERT INTO THIETBI(MaTB,TenTB,DVT,DVT_Max,DonGia,GiaNhap,SoLuongTon,NgayCapNhap,MaNL,MaNSX,MaKho)
VALUES ('1',N'MÁY TÍNH TI?N 1 ','VND','',2000000,2500000,30,'8/15/2018','2','1','3')
INSERT INTO THIETBI(MaTB,TenTB,DVT,DVT_Max,DonGia,GiaNhap,SoLuongTon,NgayCapNhap,MaNL,MaNSX,MaKho)
VALUES ('2',N'MÁY TÍNH TI?N 2','VND','',10000000,10500000,20,'7/16/2018','1','2','1')
INSERT INTO THIETBI(MaTB,TenTB,DVT,DVT_Max,DonGia,GiaNhap,SoLuongTon,NgayCapNhap,MaNL,MaNSX,MaKho)
VALUES ('3',N'MÁY TÍNH TI?N 3','VND','',1000000,1500000,10,'1/13/2017','3','3','2')

--THEM THIETBI
CREATE PROC SP_THIETBI(@MaTB NCHAR(10),@TenTB NVARCHAR(100) ,@DVT NVARCHAR(50),@DVT_Max NCHAR(10),@DonGia INT,@GiaNhap INT,@SoLuongTon INT,@NgayCapNhap DATE,@MaNL NCHAR(10),@MaNSX NCHAR(10),@MaKho NCHAR(10))
AS INSERT INTO THIETBI(MaTB,TenTB,DVT,DVT_Max,DonGia,GiaNhap,SoLuongTon,NgayCapNhap,MaNL,MaNSX,MaKho)
VALUES (@MaTB,@TenTB,@DVT,@DVT_Max,@DonGia,@GiaNhap,@SoLuongTon,@NgayCapNhap,@MaNL,@MaNSX,@MaKho)

EXEC SP_THIETBI '3',N'MÁY TÍNH TI?N 4','VND','',1004000,4500000,5,'1/3/2017','3','3','2'

--XOA THIETBI
CREATE PROC SP_XOATHIETBI(@MaTB nchar(10))
AS DELETE FROM THIETBI WHERE MaTB = @MaTB

--lay thong tin THIETBI
CREATE PROC LAYDSTHIETBI
AS
SELECT * FROM THIETBI
EXEC LAYDSTHIETBI

INSERT INTO KHACHHANG(MaKH,TenKH,MST,DiaChi,GioiTinh,SDT)
VALUES ('KH1','DÝÕNG QUÁ','113',N'C?C L?C C?C','NAM',096365632)
INSERT INTO KHACHHANG(MaKH,TenKH,MST,DiaChi,GioiTinh,SDT)
VALUES ('KH2','TRÝÕNG VÔ K?','114',N'MINH GIÁO','NAM',0935635632)
INSERT INTO KHACHHANG(MaKH,TenKH,MST,DiaChi,GioiTinh,SDT)
VALUES ('KH3','TÂY MÔN KHÁCH','115',N'THIÊN HÝÕNG L?U','NAM',0965435632)
INSERT INTO KHACHHANG(MaKH,TenKH,MST,DiaChi,GioiTinh,SDT)
VALUES ('KH4','L? M?C S?U','111',N'T? HI?N TRANG','NU',034536543)
 --THEM KHACHHANG
CREATE PROC SP_KHACHHANG(@MaKH NCHAR(10),@TenKH NVARCHAR(80),@MST NVARCHAR(20),@DiaChi NVARCHAR (50),@GioiTinh NCHAR(5),@SDT INT)
AS INSERT INTO  KHACHHANG(MaKH,TenKH,MST,DiaChi,GioiTinh,SDT)
VALUES (@MaKH,@TenKH,@MST,@DiaChi,@GioiTinh,@SDT)

EXEC SP_KHACHHANG 'KH5','L? M?C ','121',N'T? TRANG','NU',034536543

--XOA KHACHHANG
CREATE PROC SP_XOAKHACHHANG(@MaKH nchar(10))
AS DELETE FROM KHACHHANG WHERE MaKH = @MaKH

--lay thong tin KHACHHANG
CREATE PROC LAYDSKH
AS
SELECT * FROM KHACHHANG
EXEC LAYDSKH

INSERT INTO HOADON(SoHD,NgayLap_HD,ThueXuat,TongGiaTri,MaNV,MaKH)
VALUES ('HD1','6/9/2018','',3000000,'NV1','KH1')
INSERT INTO HOADON(SoHD,NgayLap_HD,ThueXuat,TongGiaTri,MaNV,MaKH)
VALUES ('HD2','7/9/2018','',4000000,'NV1','KH2')
INSERT INTO HOADON(SoHD,NgayLap_HD,ThueXuat,TongGiaTri,MaNV,MaKH)
VALUES ('HD3','6/12/2018','',3500000,'NV2','KH2')
INSERT INTO HOADON(SoHD,NgayLap_HD,ThueXuat,TongGiaTri,MaNV,MaKH)
VALUES ('HD4','12/12/2018','',500000,'NV3','KH3')

INSERT INTO CT_HOADON(SoHD,MaTB,SoLuong,DonGia,ThanhTien)
VALUES ('HD1','1',10,3000000,3500000)
INSERT INTO CT_HOADON(SoHD,MaTB,SoLuong,DonGia,ThanhTien)
VALUES ('HD2','2',1,300000,350000)
INSERT INTO CT_HOADON(SoHD,MaTB,SoLuong,DonGia,ThanhTien)
VALUES ('HD3','3',5,1000000,1500000)

--tao sp hoa don
CREATE PROC SP_THEMHOADON(@SOHD nchar(10),@NGAYLAP_HD date, @THUEXUAT nchar(20), @TONGGIATRI int, @MANV nchar(10), @MAKH nchar(10))
AS 
INSERT INTO HOADON(SoHD, NgayLap_HD, ThueXuat, TongGiaTri, MaNV, MaKH)
VALUES (@SOHD, @NGAYLAP_HD, @THUEXUAT, @TONGGIATRI, @MANV, @MAKH)
--them
exec  SP_THEMHOADON '5','5/6/1995','',6000000,'NV1','KH1'

--LAY DANH SACH HOA DON
CREATE PROC SP_LAYDANHSACHHOADON
AS
SELECT *
FROM HOADON


--XOA HOA DON
CREATE PROC SP_XOADOADON(@SOHD NCHAR(10))
AS
DELETE FROM HOADON WHERE SoHD = @SOHD

--CAP NHAP HOA DON
CREATE PROC SP_CAPNHAPHOADON(@SOHD nchar(10),@NGAYLAP_HD date, @THUEXUAT nchar(20), @TONGGIATRI int, @MANV nchar(10), @MAKH nchar(10))
AS
UPDATE HOADON
SET NgayLap_HD = @NGAYLAP_HD, ThueXuat = @THUEXUAT, TongGiaTri = @TONGGIATRI
WHERE SoHD = @SOHD

--THEM CHI TIET HOA DON
CREATE PROC SP_THEMCHITIETHOADON(@SOHD nchar(10),@MATB NCHAR(10), @SOLUONG INT, @DONGIA INT, @THANHTIEN INT)
AS 
INSERT INTO CT_HOADON(SoHD, MaTB, SoLuong, DonGia, ThanhTien)
VALUES (@SOHD, @MATB, @SOLUONG, @DONGIA, @THANHTIEN)

--them
exec  SP_THEMCHITIETHOADON '5','D32F1',50000,600000,40000

--LAY DANH SACH CHI TIET HOA DON
CREATE PROC SP_LAYDANHSACHCHITIETHOADON
AS
SELECT *
FROM CT_HOADON


--XOA CHI TIET HOA DON
CREATE PROC SP_XOACHITIETDOADON(@SOHD NCHAR(10))
AS
DELETE FROM CT_HOADON WHERE SoHD = @SOHD

--CAP NHAP CHI TIET HOA DON
CREATE PROC SP_CAPNHAPCHITIETHOADON(@SOHD nchar(10),@MATB NCHAR(10), @SOLUONG INT, @DONGIA INT, @THANHTIEN INT)
AS
UPDATE CT_HOADON
SET SoLuong = @SOLUONG, DonGia = @DONGIA, ThanhTien = @THANHTIEN
WHERE SoHD = @SOHD

--THEM  PHIEU NHAP
CREATE PROC SP_THEMPHIEUNHAP(@SOPN nchar(10),@NGAYNHAP_PN DATE, @THUEXUAT nchar(20), @TONGGIATRI int, @MANV nchar(10), @MANCC nchar(10))
AS 
INSERT INTO PHIEUNHAP(SoPN, NgayNhap_PN, ThueXuat, TongGiaTri, MaNV, MaNCC)
VALUES (@SOPN, @NGAYNHAP_PN, @THUEXUAT, @TONGGIATRI, @MANV, @MANCC)


--LAY DANH SACH PHIEU NHAP
CREATE PROC SP_LAYDANHSACHPHIEUNHAP
AS
SELECT *
FROM PHIEUNHAP


--XOA PHIEU NHAP
CREATE PROC SP_XOAPHIEUNHAP(@SOPN NCHAR(10))
AS
DELETE FROM PHIEUNHAP WHERE SoPN = @SOPN

--CAP NHAP PHIEU NHAP
CREATE PROC SP_CAPNHAPPHIEUNHAP(@SOPN nchar(10),@NGAYNHAP_PN DATE, @THUEXUAT nchar(20), @TONGGIATRI int, @MANV nchar(10), @MANCC nchar(10))
AS
UPDATE PHIEUNHAP
SET  NgayNhap_PN = @NGAYNHAP_PN, ThueXuat = @THUEXUAT, TongGiaTri = @TONGGIATRI
WHERE SoPN = @SOPN


--THEM CHI TIET PHIEU NHAP
CREATE PROC SP_THEMCHITIETPHIEUNHAP(@SOPN nchar(10),@MATB NCHAR(10), @SOLUONG INT, @GIANHAP INT, @THANHTIEN INT)
AS 
INSERT INTO CT_PHIEUNHAP(SoPN, MaTB, SoLuong, GiaNhap, ThanhTien)
VALUES (@SOPN, @MATB, @SOLUONG, @GIANHAP, @THANHTIEN)



--LAY DANH SACH CHI TIET PHIEU NHAP
CREATE PROC SP_LAYDANHSACHCHITIETPHIEUNHAP
AS
SELECT *
FROM CT_PHIEUNHAP


--XOA CHI TIET PHIEU NHAP
CREATE PROC SP_XOACHITIETPHIEUNHAP(@SOPN NCHAR(10))
AS
DELETE FROM CT_PHIEUNHAP WHERE SoPN = @SOPN

--CAP NHAP PHIEU NHAP
CREATE PROC SP_CAPNHAPCHITIETPHIEUNHAP(@SOPN nchar(10),@MATB NCHAR(10), @SOLUONG INT, @GIANHAP INT, @THANHTIEN INT)
AS
UPDATE CT_PHIEUNHAP
SET  SoLuong = @SOLUONG, GiaNhap = @GIANHAP, ThanhTien = @THANHTIEN
WHERE SoPN = @SOPN

--THEM CHI PHIEU CHI
CREATE PROC SP_THEMPHIEUCHI(@SOPC nchar(10),@NGAYNHAP_PC DATE, @LYDOCHI NVARCHAR(50), @SOTIENCHI int, @SOPN nchar(10))
AS 
INSERT INTO PHIEUCHI(SoPC, NgayLap_PC, LyDoChi, SoTienChi, SoPN)
VALUES (@SOPC, @NGAYNHAP_PC, @LYDOCHI, @SOTIENCHI, @SOPN)


--LAY DANH SACH PHIEU CHI
CREATE PROC SP_LAYDANHSACHPHIEUCHI
AS
SELECT *
FROM PHIEUCHI


--XOA PHIEU CHI
CREATE PROC SP_XOAPHIEUCHI(@SOPC NCHAR(10))
AS
DELETE FROM PHIEUCHI WHERE SoPC = @SOPC

--CAP NHAP PHIEU CHI
CREATE PROC SP_CAPNHAPPHIEUCHI(@SOPC nchar(10),@NGAYNHAP_PC DATE, @LYDOCHI NVARCHAR(50), @SOTIENCHI int, @SOPN nchar(10))
AS
UPDATE PHIEUCHI
SET  NgayLap_PC = @NGAYNHAP_PC, LyDoChi = @LYDOCHI, SoTienChi = @SOTIENCHI
WHERE SoPC = @SOPC

--THEM  BI THANH LY
CREATE PROC SP_THEMTBTHANHLY(@MATL nchar(10),@NGAYTL DATE, @LYDOTL NVARCHAR(50), @HINHTHUCTL NVARCHAR(50), @GHICHU NVARCHAR(50))
AS 
INSERT INTO TB_THANHLY(MaThanhLy, NgayThanhLy,LyDoChiThanhLy, HinhThucThanhLy, GhiChu)
VALUES (@MATL, @NGAYTL, @LYDOTL, @HINHTHUCTL, @GHICHU)


--LAY DANH SACH THIET BI THANH LY
CREATE PROC SP_LAYDANHSACHTBTHANHLY
AS
SELECT *
FROM TB_THANHLY


--XOA THIET BI THANH LY
CREATE PROC SP_XOATBTHANHLY(@MATL NCHAR(10))
AS
DELETE FROM TB_THANHLY WHERE MaThanhLy = @MATL

--CAP NHAP THIET BI THANH LY
CREATE PROC SP_CAPNHAPTBTHANHLY(@MATL nchar(10),@NGAYTL DATE, @LYDOTL NVARCHAR(50), @HINHTHUCTL NVARCHAR(50), @GHICHU NVARCHAR(50))
AS
UPDATE TB_THANHLY
SET  NgayThanhLy = @NGAYTL, LyDoChiThanhLy = @LYDOTL, HinhThucThanhLy = @HINHTHUCTL, GhiChu = @GHICHU
WHERE MaThanhLy = @MATL

--THEM CHI CHI TIET THANH LY
CREATE PROC SP_THEMCTTHANHLY(@MATL nchar(10),@MATB nchar(10), @SOLUONG INT, @DONGIA INT, @THANHTIEN INT)
AS 
INSERT INTO CT_THANHLY(MaThanhLy, MaTB, SoLuong, DonGia, ThanhTien)
VALUES (@MATL, @MATB, @SOLUONG, @DONGIA, @THANHTIEN)


--LAY DANH SACH CHI TIET THANH LY
CREATE PROC SP_LAYDANHSACHCTTHANHLY
AS
SELECT *
FROM TB_THANHLY


--XOA CHI TIET THANH LY
CREATE PROC SP_XOACTTHANHLY(@MATL NCHAR(10))
AS
DELETE FROM CT_THANHLY WHERE MaThanhLy = @MATL

--CAP NHAP THIET BI THANH LY
CREATE PROC SP_CAPNHAPCTTHANHLY(@MATL nchar(10),@MATB nchar(10), @SOLUONG INT, @DONGIA INT, @THANHTIEN INT)
AS
UPDATE CT_THANHLY
SET  SoLuong = @SOLUONG, DonGia = @DONGIA, ThanhTien = @THANHTIEN
WHERE MaThanhLy = @MATL